SETS
V        vessels                                 /v1*v40/
B        berths                                  /b1*b20/
T        times                                   /t1*t50/
CB(B)    corner berths                           /b6,b14/
CB2(B)   not assigned corner berths              /b7,b15/;
Alias(T,TO,TT1,TT2);
Alias(B,B1,B2);

PARAMETERS
P(V)     priority value of vessel v              /v1 5, v2 8, v3 10, v4 2, v5 2, v6 6, v7 10, v8 8, v9 3, v10 4, v11 4, v12 9, v13 2, v14 7, v15 8, v16 8, v17 8, v18 7, v19 2, v20 7, v21 2, v22 2, v23 3, v24 7, v25 10, v26 8, v27 3, v28 5, v29 2, v30 10, v31 9, v32 8, v33 7, v34 4, v35 9, v36 5, v37 3, v38 9, v39 6, v40 10/
PO(V)    processing time of vessel v             /v1 3, v2 2, v3 4, v4 6, v5 3, v6 7, v7 7, v8 10, v9 7, v10 3, v11 10, v12 9, v13 7, v14 2, v15 3, v16 5, v17 6, v18 5, v19 3, v20 5, v21 4, v22 8, v23 8, v24 7, v25 3, v26 7, v27 9, v28 6, v29 8, v30 2, v31 3, v32 6, v33 7, v34 8, v35 4, v36 4, v37 9, v38 3, v39 10, v40 5/
LEN(V)   length of vessel v                      /v1 1, v2 1, v3 1, v4 2, v5 2, v6 2, v7 1, v8 2, v9 2, v10 2, v11 3, v12 2, v13 3, v14 1, v15 1, v16 3, v17 1, v18 3, v19 3, v20 1, v21 1, v22 2, v23 1, v24 3, v25 2, v26 1, v27 2, v28 2, v29 2, v30 1, v31 2, v32 2, v33 2, v34 2, v35 2, v36 1, v37 3, v38 2, v39 3, v40 3/
T1(V)    expected time to arrival of vessel v    /v1 15, v2 6, v3 16, v4 13, v5 28, v6 11, v7 4, v8 29, v9 13, v10 5, v11 6, v12 23, v13 18, v14 27, v15 5, v16 20, v17 27, v18 23, v19 30, v20 4, v21 28, v22 23, v23 23, v24 25, v25 25, v26 19, v27 22, v28 20, v29 9, v30 25, v31 13, v32 17, v33 27, v34 3, v35 15, v36 11, v37 11, v38 2, v39 2, v40 30/
T2(V)    expected time to departure of vessel v  /v1 21, v2 10, v3 24, v4 25, v5 34, v6 25, v7 18, v8 49, v9 27, v10 11, v11 26, v12 41, v13 32, v14 31, v15 11, v16 30, v17 39, v18 33, v19 36, v20 14, v21 36, v22 39, v23 39, v24 39, v25 31, v26 33, v27 40, v28 32, v29 25, v30 29, v31 19, v32 29, v33 41, v34 19, v35 23, v36 19, v37 29, v38 8, v39 22, v40 40/
S(B)     available start time of berth b         /b1 3, b2 3, b3 1, b4 8, b5 5, b6 13, b7 2, b8 4, b9 15, b10 5, b11 15, b12 3, b13 2, b14 1, b15 2, b16 11, b17 11, b18 5, b19 2, b20 4/
E(B)     available end time of berth b           /b1 45, b2 39, b3 38, b4 35, b5 40, b6 42, b7 40, b8 46, b9 50, b10 50, b11 39, b12 47, b13 47, b14 36, b15 37, b16 42, b17 43, b18 37, b19 42, b20 37/;

TABLE
U(V,B)   latest time the vessel v can be assigned to berth b
           b1        b2        b3        b4        b5        b6        b7        b8        b9        b10       b11       b12       b13       b14       b15       b16       b17       b18       b19       b20
v1         21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21
v2         10        10        10        10        10        10        10        10        10        10        10        10        10        10        10        10        10        10        10        10
v3         24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24
v4         25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v5         34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34
v6         25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v7         18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18
v8         45        39        38        35        40        42        40        46        49        49        39        47        47        36        37        42        43        37        42        37
v9         27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v10        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11
v11        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26
v12        41        39        38        35        40        41        40        41        41        41        39        41        41        36        37        41        41        37        41        37
v13        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32
v14        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31
v15        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11
v16        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v17        39        39        38        35        39        39        39        39        39        39        39        39        39        36        37        39        39        37        39        37
v18        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33
v19        36        36        36        35        36        36        36        36        36        36        36        36        36        36        36        36        36        36        36        36
v20        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14
v21        36        36        36        35        36        36        36        36        36        36        36        36        36        36        36        36        36        36        36        36
v22        39        39        38        35        39        39        39        39        39        39        39        39        39        36        37        39        39        37        39        37
v23        39        39        38        35        39        39        39        39        39        39        39        39        39        36        37        39        39        37        39        37
v24        39        39        38        35        39        39        39        39        39        39        39        39        39        36        37        39        39        37        39        37
v25        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31
v26        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33
v27        40        39        38        35        40        40        40        40        40        40        39        40        40        36        37        40        40        37        40        37
v28        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32
v29        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v30        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29
v31        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19
v32        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29
v33        41        39        38        35        40        41        40        41        41        41        39        41        41        36        37        41        41        37        41        37
v34        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19
v35        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v36        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19
v37        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29
v38        8         8         8         8         8         8         8         8         8         8         8         8         8         8         8         8         8         8         8         8
v39        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22
v40        40        39        38        35        40        40        40        40        40        40        39        40        40        36        37        40        40        37        40        37
;
TABLE
L(V,B)   earliest time the vessel v can be assigned to berth b
           b1        b2        b3        b4        b5        b6        b7        b8        b9        b10       b11       b12       b13       b14       b15       b16       b17       b18       b19       b20
v1         15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15
v2         6         6         6         8         6         13        6         6         15        6         15        6         6         6         6         11        11        6         6         6
v3         16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16
v4         13        13        13        13        13        13        13        13        15        13        15        13        13        13        13        13        13        13        13        13
v5         28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v6         11        11        11        11        11        13        11        11        15        11        15        11        11        11        11        11        11        11        11        11
v7         4         4         4         8         5         13        4         4         15        5         15        4         4         4         4         11        11        5         4         4
v8         29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29
v9         13        13        13        13        13        13        13        13        15        13        15        13        13        13        13        13        13        13        13        13
v10        5         5         5         8         5         13        5         5         15        5         15        5         5         5         5         11        11        5         5         5
v11        6         6         6         8         6         13        6         6         15        6         15        6         6         6         6         11        11        6         6         6
v12        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v13        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18
v14        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v15        5         5         5         8         5         13        5         5         15        5         15        5         5         5         5         11        11        5         5         5
v16        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v17        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v18        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v19        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v20        4         4         4         8         5         13        4         4         15        5         15        4         4         4         4         11        11        5         4         4
v21        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v22        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v24        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v26        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19
v27        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22
v28        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v29        9         9         9         9         9         13        9         9         15        9         15        9         9         9         9         11        11        9         9         9
v30        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v31        13        13        13        13        13        13        13        13        15        13        15        13        13        13        13        13        13        13        13        13
v32        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17
v33        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v34        3         3         3         8         5         13        3         4         15        5         15        3         3         3         3         11        11        5         3         4
v35        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15
v36        11        11        11        11        11        13        11        11        15        11        15        11        11        11        11        11        11        11        11        11
v37        11        11        11        11        11        13        11        11        15        11        15        11        11        11        11        11        11        11        11        11
v38        3         3         2         8         5         13        2         4         15        5         15        3         2         2         2         11        11        5         2         4
v39        3         3         2         8         5         13        2         4         15        5         15        3         2         2         2         11        11        5         2         4
v40        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30;
BINARY VARIABLES
X(V,B,T);
VARIABLES
Z        objective function value;
EQUATIONS
CONST1
CONST2
CONST3
CONST4
OBJECTIVE;

CONST1(V)..                                                                                                                                      SUM( B, SUM( T $ (ORD(T)>=L(V,B) AND ORD(T)<=(U(V,B)-PO(V))), X(V,B,T))) =e= LEN(V);
CONST2(B,T) $ (ORD(T)>=S(B) AND ORD(T)<=(E(B)-1))..                                                                                              SUM( V, SUM( TO $ (ORD(TO)>=T1(V) AND ORD(TO)>=S(B) AND ORD(TO)>=(ORD(T)+1-PO(V)) AND ORD(TO)<=ORD(T) AND ORD(TO)<=(T2(V)-PO(V)) AND ORD(TO)<=(E(B)-PO(V))), X(V,B,TO))) =l= 1;
CONST3(V,T,B1,B2) $ (LEN(V)>=2 AND ORD(T)>=L(V,B1) AND ORD(T)<=(U(V,B1)-PO(V)) AND ORD(T)>=L(V,B2) AND ORD(T)<=(U(V,B2)-PO(V)))..                (X(V,B1,T) + X(V,B2,T) - 2)*999 + (ORD(B1) - ORD(B2)) =l= LEN(V) - 1;
CONST4(V,B1,B2,TT1,TT2) $ (LEN(V)>=2 AND ORD(TT1)>=L(V,B1) AND ORD(TT1)<=(U(V,B1)-PO(V)) AND ORD(TT2)>=L(V,B2) AND ORD(TT2)<=(U(V,B2)-PO(V)))..  (X(V,B1,TT1) + X(V,B2,TT2) - 2)*999 + (ORD(TT1) - ORD(TT2)) =l= 0;
OBJECTIVE..                                                                                                                                      SUM( V, SUM( B, SUM( T $ (ORD(T)>=L(V,B) AND ORD(T)<=(U(V,B)-PO(V))), P(V)*(X(V,B,T)/LEN(V))*(ORD(T) + PO(V) - T1(V))))) =e= Z;

option optCR = 0;
MODEL                    case1  /all/;
SOLVE                    case1 using MIP minimizing Z;
DISPLAY                  X.l;

