SETS
V        vessels                                 /v1*v30/
B        berths                                  /b1*b15/
T        times                                   /t1*t50/
CB(B)    corner berths                           /b4,b11/
CB2(B)   not assigned corner berths              /b5,b12/;
Alias(T,TO,TT1,TT2);
Alias(B,B1,B2);

PARAMETERS
P(V)     priority value of vessel v              /v1 2, v2 4, v3 8, v4 7, v5 5, v6 9, v7 9, v8 7, v9 7, v10 4, v11 9, v12 10, v13 8, v14 8, v15 10, v16 3, v17 3, v18 5, v19 9, v20 10, v21 7, v22 10, v23 9, v24 7, v25 2, v26 10, v27 8, v28 7, v29 9, v30 9/
PO(V)    processing time of vessel v             /v1 6, v2 10, v3 8, v4 3, v5 4, v6 2, v7 3, v8 5, v9 5, v10 8, v11 5, v12 6, v13 2, v14 3, v15 7, v16 3, v17 6, v18 4, v19 10, v20 10, v21 9, v22 10, v23 8, v24 6, v25 4, v26 6, v27 6, v28 9, v29 8, v30 4/
LEN(V)   length of vessel v                      /v1 1, v2 2, v3 2, v4 3, v5 1, v6 2, v7 1, v8 2, v9 1, v10 2, v11 1, v12 1, v13 1, v14 2, v15 3, v16 2, v17 2, v18 1, v19 3, v20 2, v21 2, v22 1, v23 2, v24 3, v25 1, v26 2, v27 1, v28 3, v29 1, v30 3/
T1(V)    expected time to arrival of vessel v    /v1 12, v2 20, v3 25, v4 18, v5 5, v6 27, v7 22, v8 10, v9 4, v10 3, v11 15, v12 28, v13 24, v14 14, v15 20, v16 12, v17 30, v18 27, v19 7, v20 28, v21 30, v22 8, v23 24, v24 22, v25 6, v26 14, v27 26, v28 27, v29 15, v30 8/
T2(V)    expected time to departure of vessel v  /v1 24, v2 40, v3 41, v4 24, v5 13, v6 31, v7 28, v8 20, v9 14, v10 19, v11 25, v12 40, v13 28, v14 20, v15 34, v16 18, v17 42, v18 35, v19 27, v20 48, v21 48, v22 28, v23 40, v24 34, v25 14, v26 26, v27 38, v28 45, v29 31, v30 16/
S(B)     available start time of berth b         /b1 4, b2 4, b3 6, b4 5, b5 1, b6 13, b7 15, b8 3, b9 4, b10 4, b11 15, b12 10, b13 8, b14 6, b15 6/
E(B)     available end time of berth b           /b1 43, b2 42, b3 40, b4 49, b5 50, b6 50, b7 38, b8 38, b9 43, b10 47, b11 47, b12 42, b13 40, b14 40, b15 40/;

TABLE
U(V,B)   latest time the vessel v can be assigned to berth b
           b1        b2        b3        b4        b5        b6        b7        b8        b9        b10       b11       b12       b13       b14       b15
v1         24        24        24        24        24        24        24        24        24        24        24        24        24        24        24
v2         40        40        40        40        40        40        38        38        40        40        40        40        40        40        40
v3         41        41        40        41        41        41        38        38        41        41        41        41        40        40        40
v4         24        24        24        24        24        24        24        24        24        24        24        24        24        24        24
v5         13        13        13        13        13        13        13        13        13        13        13        13        13        13        13
v6         31        31        31        31        31        31        31        31        31        31        31        31        31        31        31
v7         28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v8         20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v9         14        14        14        14        14        14        14        14        14        14        14        14        14        14        14
v10        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19
v11        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v12        40        40        40        40        40        40        38        38        40        40        40        40        40        40        40
v13        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v14        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v15        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34
v16        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18
v17        42        42        40        42        42        42        38        38        42        42        42        42        40        40        40
v18        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35
v19        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v20        43        42        40        48        48        48        38        38        43        47        47        42        40        40        40
v21        43        42        40        48        48        48        38        38        43        47        47        42        40        40        40
v22        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v23        40        40        40        40        40        40        38        38        40        40        40        40        40        40        40
v24        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34
v25        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14
v26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26
v27        38        38        38        38        38        38        38        38        38        38        38        38        38        38        38
v28        43        42        40        45        45        45        38        38        43        45        45        42        40        40        40
v29        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31
v30        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16;
TABLE
L(V,B)   earliest time the vessel v can be assigned to berth b
           b1        b2        b3        b4        b5        b6        b7        b8        b9        b10       b11       b12       b13       b14       b15
v1         12        12        12        12        12        13        15        12        12        12        15        12        12        12        12
v2         20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v3         25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v4         18        18        18        18        18        18        18        18        18        18        18        18        18        18        18
v5         5         5         6         5         5         13        15        5         5         5         15        10        8         6         6
v6         27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v7         22        22        22        22        22        22        22        22        22        22        22        22        22        22        22
v8         10        10        10        10        10        13        15        10        10        10        15        10        10        10        10
v9         4         4         6         5         4         13        15        4         4         4         15        10        8         6         6
v10        4         4         6         5         3         13        15        3         4         4         15        10        8         6         6
v11        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15
v12        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v13        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24
v14        14        14        14        14        14        14        15        14        14        14        15        14        14        14        14
v15        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v16        12        12        12        12        12        13        15        12        12        12        15        12        12        12        12
v17        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v18        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v19        7         7         7         7         7         13        15        7         7         7         15        10        8         7         7
v20        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v21        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v22        8         8         8         8         8         13        15        8         8         8         15        10        8         8         8
v23        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24
v24        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22
v25        6         6         6         6         6         13        15        6         6         6         15        10        8         6         6
v26        14        14        14        14        14        14        15        14        14        14        15        14        14        14        14
v27        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26
v28        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v29        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15
v30        8         8         8         8         8         13        15        8         8         8         15        10        8         8         8;
BINARY VARIABLES
X(V,B,T);
VARIABLES
Z        objective function value;
EQUATIONS
CONST1
CONST2
CONST3
CONST4
OBJECTIVE;

CONST1(V)..                                                                                                                                      SUM( B, SUM( T $ (ORD(T)>=L(V,B) AND ORD(T)<=(U(V,B)-PO(V))), X(V,B,T))) =e= LEN(V);
CONST2(B,T) $ (ORD(T)>=S(B) AND ORD(T)<=(E(B)-1))..                                                                                              SUM( V, SUM( TO $ (ORD(TO)>=T1(V) AND ORD(TO)>=S(B) AND ORD(TO)>=(ORD(T)+1-PO(V)) AND ORD(TO)<=ORD(T) AND ORD(TO)<=(T2(V)-PO(V)) AND ORD(TO)<=(E(B)-PO(V))), X(V,B,TO))) =l= 1;
CONST3(V,T,B1,B2) $ (LEN(V)>=2 AND ORD(T)>=L(V,B1) AND ORD(T)<=(U(V,B1)-PO(V)) AND ORD(T)>=L(V,B2) AND ORD(T)<=(U(V,B2)-PO(V)))..                (X(V,B1,T) + X(V,B2,T) - 2)*999 + (ORD(B1) - ORD(B2)) =l= LEN(V) - 1;
CONST4(V,B1,B2,TT1,TT2) $ (LEN(V)>=2 AND ORD(TT1)>=L(V,B1) AND ORD(TT1)<=(U(V,B1)-PO(V)) AND ORD(TT2)>=L(V,B2) AND ORD(TT2)<=(U(V,B2)-PO(V)))..  (X(V,B1,TT1) + X(V,B2,TT2) - 2)*999 + (ORD(TT1) - ORD(TT2)) =l= 0;
OBJECTIVE..                                                                                                                                      SUM( V, SUM( B, SUM( T $ (ORD(T)>=L(V,B) AND ORD(T)<=(U(V,B)-PO(V))), P(V)*(X(V,B,T)/LEN(V))*(ORD(T) + PO(V) - T1(V))))) =e= Z;

option optCR = 0;
MODEL                    case1  /all/;
SOLVE                    case1 using MIP minimizing Z;
DISPLAY                  X.l;

