SETS
V        vessels                                 /v1*v30/
B        berths                                  /b1*b15/
T        times                                   /t1*t50/
CB(B)    corner berths                           /b4,b11/
CB2(B)   not assigned corner berths              /b5,b12/;
Alias(T,TO,TT1,TT2);
Alias(B,B1,B2);

PARAMETERS
P(V)     priority value of vessel v              /v1 10, v2 5, v3 3, v4 6, v5 7, v6 2, v7 3, v8 5, v9 10, v10 8, v11 8, v12 4, v13 8, v14 8, v15 5, v16 7, v17 10, v18 10, v19 5, v20 2, v21 2, v22 7, v23 10, v24 8, v25 7, v26 9, v27 4, v28 3, v29 6, v30 5/
PO(V)    processing time of vessel v             /v1 3, v2 4, v3 3, v4 9, v5 4, v6 2, v7 5, v8 3, v9 5, v10 2, v11 10, v12 5, v13 3, v14 9, v15 2, v16 3, v17 10, v18 10, v19 3, v20 10, v21 10, v22 7, v23 8, v24 3, v25 5, v26 5, v27 8, v28 5, v29 5, v30 9/
LEN(V)   length of vessel v                      /v1 1, v2 1, v3 1, v4 2, v5 2, v6 1, v7 1, v8 2, v9 1, v10 1, v11 2, v12 2, v13 2, v14 2, v15 2, v16 3, v17 3, v18 1, v19 3, v20 3, v21 1, v22 1, v23 1, v24 2, v25 3, v26 2, v27 3, v28 1, v29 2, v30 2/
T1(V)    expected time to arrival of vessel v    /v1 2, v2 6, v3 19, v4 5, v5 17, v6 7, v7 24, v8 11, v9 30, v10 13, v11 23, v12 21, v13 15, v14 29, v15 8, v16 20, v17 3, v18 13, v19 27, v20 2, v21 13, v22 21, v23 16, v24 13, v25 29, v26 26, v27 15, v28 24, v29 27, v30 5/
T2(V)    expected time to departure of vessel v  /v1 8, v2 14, v3 25, v4 23, v5 25, v6 11, v7 34, v8 17, v9 40, v10 17, v11 43, v12 31, v13 21, v14 47, v15 12, v16 26, v17 23, v18 33, v19 33, v20 22, v21 33, v22 35, v23 32, v24 19, v25 39, v26 36, v27 31, v28 34, v29 37, v30 23/
S(B)     available start time of berth b         /b1 5, b2 3, b3 3, b4 1, b5 10, b6 8, b7 7, b8 2, b9 2, b10 1, b11 5, b12 6, b13 13, b14 15, b15 7/
E(B)     available end time of berth b           /b1 40, b2 38, b3 49, b4 50, b5 50, b6 41, b7 43, b8 39, b9 43, b10 36, b11 50, b12 50, b13 47, b14 35, b15 40/;

TABLE
U(V,B)   latest time the vessel v can be assigned to berth b
           b1        b2        b3        b4        b5        b6        b7        b8        b9        b10       b11       b12       b13       b14       b15
v1         8         8         8         8         8         8         8         8         8         8         8         8         8         8         8
v2         14        14        14        14        14        14        14        14        14        14        14        14        14        14        14
v3         25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v4         23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v5         25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v6         11        11        11        11        11        11        11        11        11        11        11        11        11        11        11
v7         34        34        34        34        34        34        34        34        34        34        34        34        34        34        34
v8         17        17        17        17        17        17        17        17        17        17        17        17        17        17        17
v9         40        38        40        40        40        40        40        39        40        36        40        40        40        35        40
v10        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17
v11        40        38        43        43        43        41        43        39        43        36        43        43        43        35        40
v12        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31
v13        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21
v14        40        38        47        47        47        41        43        39        43        36        47        47        47        35        40
v15        12        12        12        12        12        12        12        12        12        12        12        12        12        12        12
v16        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26
v17        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v18        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33
v19        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33
v20        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22
v21        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33
v22        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35
v23        32        32        32        32        32        32        32        32        32        32        32        32        32        32        32
v24        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19
v25        39        38        39        39        39        39        39        39        39        36        39        39        39        35        39
v26        36        36        36        36        36        36        36        36        36        36        36        36        36        35        36
v27        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31
v28        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34
v29        37        37        37        37        37        37        37        37        37        36        37        37        37        35        37
v30        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23;
TABLE
L(V,B)   earliest time the vessel v can be assigned to berth b
           b1        b2        b3        b4        b5        b6        b7        b8        b9        b10       b11       b12       b13       b14       b15
v1         5         3         3         2         10        8         7         2         2         2         5         6         13        15        7
v2         6         6         6         6         10        8         7         6         6         6         6         6         13        15        7
v3         19        19        19        19        19        19        19        19        19        19        19        19        19        19        19
v4         5         5         5         5         10        8         7         5         5         5         5         6         13        15        7
v5         17        17        17        17        17        17        17        17        17        17        17        17        17        17        17
v6         7         7         7         7         10        8         7         7         7         7         7         7         13        15        7
v7         24        24        24        24        24        24        24        24        24        24        24        24        24        24        24
v8         11        11        11        11        11        11        11        11        11        11        11        11        13        15        11
v9         30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v10        13        13        13        13        13        13        13        13        13        13        13        13        13        15        13
v11        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v12        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21
v13        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15
v14        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29
v15        8         8         8         8         10        8         8         8         8         8         8         8         13        15        8
v16        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v17        5         3         3         3         10        8         7         3         3         3         5         6         13        15        7
v18        13        13        13        13        13        13        13        13        13        13        13        13        13        15        13
v19        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v20        5         3         3         2         10        8         7         2         2         2         5         6         13        15        7
v21        13        13        13        13        13        13        13        13        13        13        13        13        13        15        13
v22        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21
v23        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16
v24        13        13        13        13        13        13        13        13        13        13        13        13        13        15        13
v25        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29
v26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26
v27        15        15        15        15        15        15        15        15        15        15        15        15        15        15        15
v28        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24
v29        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v30        5         5         5         5         10        8         7         5         5         5         5         6         13        15        7;
BINARY VARIABLES
X(V,B,T);
VARIABLES
Z        objective function value;
EQUATIONS
CONST1
CONST2
CONST3
CONST4
CONST5
OBJECTIVE;

CONST1(V)..                                                                                                                                      SUM( B, SUM( T $ (ORD(T)>=L(V,B) AND ORD(T)<=(U(V,B)-PO(V))), X(V,B,T))) =e= LEN(V);
CONST2(B,T) $ (ORD(T)>=S(B) AND ORD(T)<=(E(B)-1))..                                                                                              SUM( V, SUM( TO $ (ORD(TO)>=T1(V) AND ORD(TO)>=S(B) AND ORD(TO)>=(ORD(T)+1-PO(V)) AND ORD(TO)<=ORD(T) AND ORD(TO)<=(T2(V)-PO(V)) AND ORD(TO)<=(E(B)-PO(V))), X(V,B,TO))) =l= 1;
CONST3(V,T,B1,B2) $ (LEN(V)>=2 AND ORD(T)>=L(V,B1) AND ORD(T)<=(U(V,B1)-PO(V)) AND ORD(T)>=L(V,B2) AND ORD(T)<=(U(V,B2)-PO(V)))..                (X(V,B1,T) + X(V,B2,T) - 2)*999 + (ORD(B1) - ORD(B2)) =l= LEN(V) - 1;
CONST4(V,B1,B2,TT1,TT2) $ (LEN(V)>=2 AND ORD(TT1)>=L(V,B1) AND ORD(TT1)<=(U(V,B1)-PO(V)) AND ORD(TT2)>=L(V,B2) AND ORD(TT2)<=(U(V,B2)-PO(V)))..  (X(V,B1,TT1) + X(V,B2,TT2) - 2)*999 + (ORD(TT1) - ORD(TT2)) =l= 0;
CONST5(V,CB,CB2,T) $ (LEN(V)>=2 AND ORD(T)>=L(V,CB) AND ORD(T)<=(U(V,CB)-PO(V)) AND ORD(CB)+1=ORD(CB2))..                                        (X(V,CB,T)+X(V,CB2,T)) =l= 1;
OBJECTIVE..                                                                                                                                      SUM( V, SUM( B, SUM( T $ (ORD(T)>=L(V,B) AND ORD(T)<=(U(V,B)-PO(V))), P(V)*(X(V,B,T)/LEN(V))*(ORD(T) + PO(V) - T1(V))))) =e= Z;

option optCR = 0;
MODEL                    case1  /all/;
SOLVE                    case1 using MIP minimizing Z;
DISPLAY                  X.l;

