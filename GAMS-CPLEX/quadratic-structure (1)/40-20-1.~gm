SETS
V        vessels                                 /v1*v40/
B        berths                                  /b1*b20/
T        times                                   /t1*t50/
CB(B)    corner berths                           /b6,b14/
CB2(B)   not assigned corner berths              /b7,b15/;
Alias(T,TO,TT1,TT2);
Alias(B,B1,B2);

PARAMETERS
P(V)     priority value of vessel v              /v1 8, v2 2, v3 9, v4 8, v5 4, v6 2, v7 7, v8 10, v9 2, v10 6, v11 10, v12 6, v13 8, v14 6, v15 9, v16 9, v17 4, v18 3, v19 8, v20 6, v21 4, v22 3, v23 2, v24 3, v25 3, v26 8, v27 2, v28 8, v29 6, v30 2, v31 7, v32 5, v33 4, v34 7, v35 2, v36 5, v37 8, v38 10, v39 4, v40 6/
PO(V)    processing time of vessel v             /v1 10, v2 6, v3 5, v4 10, v5 8, v6 2, v7 10, v8 7, v9 8, v10 6, v11 10, v12 6, v13 6, v14 7, v15 10, v16 3, v17 9, v18 2, v19 5, v20 9, v21 8, v22 7, v23 9, v24 6, v25 2, v26 9, v27 6, v28 2, v29 8, v30 8, v31 8, v32 6, v33 10, v34 9, v35 8, v36 9, v37 6, v38 3, v39 10, v40 7/
LEN(V)   length of vessel v                      /v1 3, v2 1, v3 2, v4 2, v5 1, v6 3, v7 2, v8 1, v9 1, v10 1, v11 3, v12 1, v13 2, v14 1, v15 2, v16 2, v17 2, v18 2, v19 1, v20 2, v21 2, v22 1, v23 1, v24 2, v25 3, v26 2, v27 3, v28 1, v29 3, v30 1, v31 2, v32 1, v33 3, v34 1, v35 1, v36 2, v37 1, v38 3, v39 3, v40 3/
T1(V)    expected time to arrival of vessel v    /v1 30, v2 23, v3 30, v4 23, v5 30, v6 23, v7 2, v8 26, v9 28, v10 2, v11 11, v12 26, v13 13, v14 12, v15 29, v16 5, v17 10, v18 20, v19 18, v20 28, v21 30, v22 22, v23 13, v24 25, v25 1, v26 20, v27 17, v28 12, v29 4, v30 4, v31 2, v32 21, v33 10, v34 19, v35 17, v36 12, v37 7, v38 28, v39 29, v40 21/
T2(V)    expected time to departure of vessel v  /v1 50, v2 35, v3 40, v4 43, v5 46, v6 27, v7 22, v8 40, v9 44, v10 14, v11 31, v12 38, v13 25, v14 26, v15 49, v16 11, v17 28, v18 24, v19 28, v20 46, v21 46, v22 36, v23 31, v24 37, v25 5, v26 38, v27 29, v28 16, v29 20, v30 20, v31 18, v32 33, v33 30, v34 37, v35 33, v36 30, v37 19, v38 34, v39 49, v40 35/
S(B)     available start time of berth b         /b1 1, b2 2, b3 2, b4 1, b5 3, b6 5, b7 13, b8 15, b9 6, b10 6, b11 4, b12 2, b13 1, b14 1, b15 5, b16 8, b17 13, b18 15, b19 5, b20 5/
E(B)     available end time of berth b           /b1 50, b2 50, b3 50, b4 43, b5 41, b6 40, b7 40, b8 35, b9 43, b10 48, b11 50, b12 50, b13 43, b14 41, b15 38, b16 40, b17 40, b18 48, b19 48, b20 50/;

TABLE
U(V,B)   latest time the vessel v can be assigned to berth b
           b1        b2        b3        b4        b5        b6        b7        b8        b9        b10       b11       b12       b13       b14       b15       b16       b17       b18       b19       b20
v1         50        50        50        43        41        40        40        35        43        48        50        50        43        41        38        40        40        48        48        50
v2         35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35
v3         40        40        40        40        40        40        40        35        40        40        40        40        40        40        38        40        40        40        40        40
v4         43        43        43        43        41        40        40        35        43        43        43        43        43        41        38        40        40        43        43        43
v5         46        46        46        43        41        40        40        35        43        46        46        46        43        41        38        40        40        46        46        46
v6         27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27        27
v7         22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22
v8         40        40        40        40        40        40        40        35        40        40        40        40        40        40        38        40        40        40        40        40
v9         44        44        44        43        41        40        40        35        43        44        44        44        43        41        38        40        40        44        44        44
v10        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14        14
v11        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31
v12        38        38        38        38        38        38        38        35        38        38        38        38        38        38        38        38        38        38        38        38
v13        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v14        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26
v15        49        49        49        43        41        40        40        35        43        48        49        49        43        41        38        40        40        48        48        49
v16        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11        11
v17        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v18        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24        24
v19        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v20        46        46        46        43        41        40        40        35        43        46        46        46        43        41        38        40        40        46        46        46
v21        46        46        46        43        41        40        40        35        43        46        46        46        43        41        38        40        40        46        46        46
v22        36        36        36        36        36        36        36        35        36        36        36        36        36        36        36        36        36        36        36        36
v23        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31        31
v24        37        37        37        37        37        37        37        35        37        37        37        37        37        37        37        37        37        37        37        37
v25        5         5         5         5         5         5         5         5         5         5         5         5         5         5         5         5         5         5         5         5
v26        38        38        38        38        38        38        38        35        38        38        38        38        38        38        38        38        38        38        38        38
v27        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29
v28        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16        16
v29        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v30        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v31        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18
v32        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33
v33        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v34        37        37        37        37        37        37        37        35        37        37        37        37        37        37        37        37        37        37        37        37
v35        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33        33
v36        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v37        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19
v38        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34        34
v39        49        49        49        43        41        40        40        35        43        48        49        49        43        41        38        40        40        48        48        49
v40        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35        35;
TABLE
L(V,B)   earliest time the vessel v can be assigned to berth b
           b1        b2        b3        b4        b5        b6        b7        b8        b9        b10       b11       b12       b13       b14       b15       b16       b17       b18       b19       b20
v1         30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v2         23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v3         30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v4         23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v5         30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v6         23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23        23
v7         2         2         2         2         3         5         13        15        6         6         4         2         2         2         5         8         13        15        5         5
v8         26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26
v9         28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v10        2         2         2         2         3         5         13        15        6         6         4         2         2         2         5         8         13        15        5         5
v11        11        11        11        11        11        11        13        15        11        11        11        11        11        11        11        11        13        15        11        11
v12        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26        26
v13        13        13        13        13        13        13        13        15        13        13        13        13        13        13        13        13        13        15        13        13
v14        12        12        12        12        12        12        13        15        12        12        12        12        12        12        12        12        13        15        12        12
v15        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29
v16        5         5         5         5         5         5         13        15        6         6         5         5         5         5         5         8         13        15        5         5
v17        10        10        10        10        10        10        13        15        10        10        10        10        10        10        10        10        13        15        10        10
v18        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v19        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18        18
v20        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v21        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30        30
v22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22        22
v23        13        13        13        13        13        13        13        15        13        13        13        13        13        13        13        13        13        15        13        13
v24        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25        25
v25        1         2         2         1         3         5         13        15        6         6         4         2         1         1         5         8         13        15        5         5
v26        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20        20
v27        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17
v28        12        12        12        12        12        12        13        15        12        12        12        12        12        12        12        12        13        15        12        12
v29        4         4         4         4         4         5         13        15        6         6         4         4         4         4         5         8         13        15        5         5
v30        4         4         4         4         4         5         13        15        6         6         4         4         4         4         5         8         13        15        5         5
v31        2         2         2         2         3         5         13        15        6         6         4         2         2         2         5         8         13        15        5         5
v32        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21
v33        10        10        10        10        10        10        13        15        10        10        10        10        10        10        10        10        13        15        10        10
v34        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19        19
v35        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17        17
v36        12        12        12        12        12        12        13        15        12        12        12        12        12        12        12        12        13        15        12        12
v37        7         7         7         7         7         7         13        15        7         7         7         7         7         7         7         8         13        15        7         7
v38        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28        28
v39        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29        29
v40        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21        21
;
BINARY VARIABLES
X(V,B,T);
VARIABLES
Z        objective function value;
EQUATIONS
CONST1
CONST2
CONST3
CONST4
CONST5
OBJECTIVE;

CONST1(V)..                                                                                                                                      SUM( B, SUM( T $ (ORD(T)>=L(V,B) AND ORD(T)<=(U(V,B)-PO(V))), X(V,B,T))) =e= LEN(V);
CONST2(B,T) $ (ORD(T)>=S(B) AND ORD(T)<=(E(B)-1))..                                                                                              SUM( V, SUM( TO $ (ORD(TO)>=T1(V) AND ORD(TO)>=S(B) AND ORD(TO)>=(ORD(T)+1-PO(V)) AND ORD(TO)<=ORD(T) AND ORD(TO)<=(T2(V)-PO(V)) AND ORD(TO)<=(E(B)-PO(V))), X(V,B,TO))) =l= 1;
CONST3(V,T,B1,B2) $ (LEN(V)>=2 AND ORD(T)>=L(V,B1) AND ORD(T)<=(U(V,B1)-PO(V)) AND ORD(T)>=L(V,B2) AND ORD(T)<=(U(V,B2)-PO(V)))..                (X(V,B1,T) + X(V,B2,T) - 2)*999 + (ORD(B1) - ORD(B2)) =l= LEN(V) - 1;
CONST4(V,B1,B2,TT1,TT2) $ (LEN(V)>=2 AND ORD(TT1)>=L(V,B1) AND ORD(TT1)<=(U(V,B1)-PO(V)) AND ORD(TT2)>=L(V,B2) AND ORD(TT2)<=(U(V,B2)-PO(V)))..  (X(V,B1,TT1) + X(V,B2,TT2) - 2)*999 + (ORD(TT1) - ORD(TT2)) =l= 0;
CONST5(V,CB,CB2,T) $ (LEN(V)>=2 AND ORD(T)>=L(V,CB) AND ORD(T)<=(U(V,CB)-PO(V)) AND ORD(CB)=ORD(CB2))..                                        (X(V,CB,T)+X(V,CB2,T)) =l= 1;
OBJECTIVE..                                                                                                                                      SUM( V, SUM( B, SUM( T $ (ORD(T)>=L(V,B) AND ORD(T)<=(U(V,B)-PO(V))), P(V)*(X(V,B,T)/LEN(V))*(ORD(T) + PO(V) - T1(V))))) =e= Z;

option optCR = 0;
MODEL                    case1  /all/;
SOLVE                    case1 using MIP minimizing Z;
DISPLAY                  X.l;

